<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>THá» FRUITS</title>
    <style>
        body {
            font-family: Arial;
            background: #f5f5f5;
            margin: 0;
        }

        header {
            background: #ff4d6d;
            color: #fff;
            padding: 15px;
            text-align: center;
            font-size: 22px;
        }

        .container {
            padding: 15px;
            max-width: 1000px;
            margin: auto;
        }

        .box {
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        input,
        button,
        select {
            width: 100%;
            padding: 10px;
            margin-top: 8px;
        }

        button {
            border: none;
            cursor: pointer;
            color: #fff;
        }

        .add {
            background: #28a745;
        }

        .cart-btn {
            background: #ff9800;
        }

        .checkout {
            background: #dc3545;
        }

        .reset {
            background: #6c757d;
        }

        .products {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .product {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
            border-radius: 6px;
        }

        .product img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .order {
            border-bottom: 1px solid #ddd;
            padding: 10px 0;
        }

        .admin-only {
            display: none;
        }

        .qr-box {
            background: #f1f1f1;
            padding: 10px;
            margin-top: 10px;
            text-align: center;
            border-radius: 6px;
        }

        .qr-box img {
            width: 200px;
        }

        #transferModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #transferModal .modal-content {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            position: relative;
        }

        #transferModal h3 {
            color: #ff6600;
            margin-bottom: 10px;
        }

        #transferModal input[type="file"] {
            margin: 15px 0;
        }

        #transferModal button {
            width: 48%;
            margin: 5px 1%;
        }

        #closeModal {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <header>ğŸ“ THá» FRUITS ğŸ“</header>

    <div class="container">

        <!-- ADMIN LOGIN -->
        <div class="box">
            <h3>ğŸ” Cháº¿ Ä‘á»™ chá»§ shop</h3>
            <input id="adminPass" type="password" placeholder="Nháº­p máº­t kháº©u admin">
            <button class="add" onclick="loginAdmin()">ÄÄƒng nháº­p</button>
        </div>

        <!-- ADMIN PANEL -->
        <div class="box admin-only" id="adminPanel">
            <h3>ğŸ‘¨â€ğŸ’¼ Quáº£n lÃ½ sáº£n pháº©m</h3>
            <input id="pName" placeholder="TÃªn sáº£n pháº©m">
            <input id="pPrice" type="number" placeholder="GiÃ¡ (VNÄ)">
            <input id="pImage" placeholder="Link hÃ¬nh áº£nh">
            <button class="add" onclick="addProduct()">â• ThÃªm sáº£n pháº©m</button>
            <button class="reset" onclick="resetProducts()">ğŸ—‘ Reset toÃ n bá»™ sáº£n pháº©m</button>

            <h3>ğŸ“¦ ÄÆ¡n hÃ ng khÃ¡ch Ä‘áº·t</h3>
            <div id="orders"></div>
            <button class="reset" onclick="resetOrders()">ğŸ—‘ Reset toÃ n bá»™ Ä‘Æ¡n hÃ ng</button>
        </div>

        <!-- SHOP -->
        <div class="box">
            <h3>ğŸ› Sáº£n pháº©m</h3>
            <div class="products" id="products"></div>
        </div>

        <!-- CART -->
        <div class="box">
            <h3>ğŸ›’ Giá» hÃ ng</h3>
            <div id="cart"></div>
            <b>Tá»•ng tiá»n:</b> <span id="total">0</span> VNÄ

            <input id="address" placeholder="Äá»‹a chá»‰ giao hÃ ng">
            <input id="phone" placeholder="Sá»‘ Ä‘iá»‡n thoáº¡i (10 sá»‘)">

            <select id="payment">
                <option value="">-- Chá»n phÆ°Æ¡ng thá»©c thanh toÃ¡n --</option>
                <option value="Tiá»n máº·t">ğŸ’µ Thanh toÃ¡n tiá»n máº·t</option>
                <option value="Chuyá»ƒn khoáº£n">ğŸ’³ Chuyá»ƒn khoáº£n ngÃ¢n hÃ ng</option>
            </select>

            <button class="checkout" onclick="checkout()">âœ… Äáº·t hÃ ng</button>
        </div>

        <!-- TRANSFER MODAL -->
        <div id="transferModal">
            <div class="modal-content">
                <span id="closeModal" onclick="closeModal()">Ã—</span>
                <h3>ğŸ’³ XÃC NHáº¬N CHUYá»‚N KHOáº¢N</h3>
                <p>Vui lÃ²ng chuyá»ƒn khoáº£n vÃ  táº£i áº£nh biÃªn lai Ä‘á»ƒ hoÃ n táº¥t Ä‘Æ¡n hÃ ng.</p>

                <!-- QR CODE -->
                <div class="qr-box">
                    <b>ğŸ’³ ThÃ´ng tin chuyá»ƒn khoáº£n</b><br><br>
                    <img src='https://img.vietqr.io/image/vietcombank-0011001483419-compact.jpg' />
                    <p><b>NgÃ¢n hÃ ng:</b> Vietcombank</p>
                    <p><b>Sá»‘ TK:</b> 0011001483419</p>
                    <p><b>Chá»§ TK:</b> CAM THI THUY ANH</p>
                    <small>ğŸ“Œ Ná»™i dung CK: SÄT Ä‘áº·t hÃ ng</small>
                </div>

                <input type="file" id="transferSlip" accept="image/*">
                <div>
                    <button class="add" onclick="confirmTransfer()">âœ… XÃ¡c nháº­n</button>
                    <button class="reset" onclick="closeModal()">âŒ Há»§y</button>
                </div>
            </div>
        </div>

        <script>
            const ADMIN_PASSWORD = "Xuanthang0707@";
            let products = JSON.parse(localStorage.getItem("products")) || [];
            let orders = JSON.parse(localStorage.getItem("orders")) || [];
            let cart = [];

            const productsDiv = document.getElementById("products");
            const cartDiv = document.getElementById("cart");
            const totalSpan = document.getElementById("total");
            const ordersDiv = document.getElementById("orders");
            const payment = document.getElementById("payment");
            const transferModal = document.getElementById("transferModal");
            const transferSlip = document.getElementById("transferSlip");

            // ADMIN LOGIN
            function loginAdmin() {
                const adminPass = document.getElementById("adminPass");
                if (adminPass.value === ADMIN_PASSWORD) {
                    document.querySelectorAll(".admin-only").forEach(e => e.style.display = "block");
                    renderOrders();
                    alert("ÄÄƒng nháº­p admin thÃ nh cÃ´ng!");
                } else alert("Sai máº­t kháº©u!");
            }

            // PRODUCTS
            function saveProducts() { localStorage.setItem("products", JSON.stringify(products)); }
            function addProduct() {
                const pName = document.getElementById("pName").value.trim();
                const pPrice = document.getElementById("pPrice").value.trim();
                const pImage = document.getElementById("pImage").value.trim();
                if (!pName || !pPrice || !pImage) return alert("Nháº­p Ä‘á»§ thÃ´ng tin");
                products.push({ name: pName, price: pPrice, image: pImage });
                saveProducts(); renderProducts();
                document.getElementById("pName").value = document.getElementById("pPrice").value = document.getElementById("pImage").value = "";
            }
            function renderProducts() {
                productsDiv.innerHTML = products.map((p, i) => `
    <div class="product">
        <img src="${p.image}">
        <b>${p.name}</b>
        <p>${p.price} VNÄ</p>
        <button class="cart-btn" onclick="addToCart(${i})">ThÃªm giá»</button>
    </div>`).join("");
            }
            function resetProducts() {
                if (confirm("XÃ“A TOÃ€N Bá»˜ Sáº¢N PHáº¨M?")) { products = []; saveProducts(); renderProducts(); }
            }

            // CART
            function addToCart(i) { cart.push(products[i]); renderCart(); }
            function renderCart() {
                let total = 0;
                cartDiv.innerHTML = cart.map(p => { total += Number(p.price); return `<div>${p.name} - ${p.price} VNÄ</div>` }).join("");
                totalSpan.innerText = total;
            }

            // CHECKOUT
            function checkout() {
                const address = document.getElementById("address").value.trim();
                const phone = document.getElementById("phone").value.trim();
                if (!address) return alert("Nháº­p Ä‘á»‹a chá»‰");
                if (!/^\d{10}$/.test(phone)) return alert("SÄT khÃ´ng há»£p lá»‡");
                if (!payment.value) return alert("Chá»n phÆ°Æ¡ng thá»©c thanh toÃ¡n");
                if (cart.length === 0) return alert("Giá» hÃ ng trá»‘ng");

                if (payment.value === "Chuyá»ƒn khoáº£n") {
                    transferModal.style.display = "flex"; // hiá»‡n modal QR + upload
                    return;
                }

                saveOrder({ paid: "ÄÃ£ thanh toÃ¡n" });
            }

            function saveOrder(extra = {}) {
                const address = document.getElementById("address").value.trim();
                const phone = document.getElementById("phone").value.trim();

                const newOrder = {
                    id: Date.now(),
                    time: new Date().toLocaleString(),
                    phone: phone,
                    address: address,
                    payment: payment.value,
                    items: cart,
                    total: totalSpan.innerText,
                    slip: extra.slip || "",
                    paid: extra.paid || ""
                };
                orders.push(newOrder);
                localStorage.setItem("orders", JSON.stringify(orders));

                alert("ğŸ‰ Äáº·t hÃ ng thÃ nh cÃ´ng!");
                cart = []; renderCart();
                document.getElementById("address").value = document.getElementById("phone").value = "";
                payment.value = ""; transferSlip.value = ""; transferModal.style.display = "none";
                renderOrders();
            }

            // TRANSFER MODAL
            function closeModal() { transferModal.style.display = "none"; transferSlip.value = ""; }
            function confirmTransfer() {
                if (!transferSlip.files[0]) return alert("Vui lÃ²ng táº£i áº£nh biÃªn lai!");
                const slipURL = URL.createObjectURL(transferSlip.files[0]);
                saveOrder({ slip: slipURL, paid: "Chá» admin xÃ¡c nháº­n" });
            }

            // ORDERS
            function renderOrders() {
                ordersDiv.innerHTML = orders.map(o => `
    <div class="order">
        <b>ğŸ•’ ${o.time}</b><br>
        ğŸ“ ${o.phone}<br>
        ğŸ“ ${o.address}<br>
        ğŸ’³ ${o.payment}<br>
        ğŸ›’ ${o.items.map(i => i.name).join(", ")}<br>
        ğŸ’° ${o.total} VNÄ<br>
        ${o.payment === "Chuyá»ƒn khoáº£n" ? `<a href="${o.slip}" target="_blank">ğŸ“„ Xem biÃªn lai</a><br>` : ""}
        <span class="order-status">Tráº¡ng thÃ¡i: ${o.paid}</span><br>
        ${o.payment === "Chuyá»ƒn khoáº£n" && o.paid === "Chá» admin xÃ¡c nháº­n" ? `<button class="add" onclick="confirmPayment(${o.id})">âœ… XÃ¡c nháº­n thanh toÃ¡n</button>` : ""}
    </div>`).join("");
            }

            function confirmPayment(orderId) {
                const index = orders.findIndex(o => o.id === orderId);
                if (index !== -1) {
                    orders[index].paid = "ÄÃ£ thanh toÃ¡n";
                    localStorage.setItem("orders", JSON.stringify(orders));
                    renderOrders();
                    alert("âœ… ÄÆ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c nháº­n thanh toÃ¡n!");
                }
            }

            function resetOrders() {
                if (confirm("XÃ“A TOÃ€N Bá»˜ ÄÆ N HÃ€NG?")) { orders = []; localStorage.setItem("orders", JSON.stringify(orders)); renderOrders(); }
            }

            // INIT
            renderProducts();
            renderOrders();
        </script>

</body>

</html>
